高校智能择校与导师匹配系统 开发文档

一、项目背景

本系统旨在为学生提供智能化的择校与导师匹配服务。数据来源为各高校官方网站与院系公开招生信息，保证合法合规。

二、技术选型
后端

语言：Java

框架：Spring Boot + Spring Cloud（后期可扩展）

数据库 ORM：MyBatis-Plus

工具库：Hutool

API 交互：RESTful API

数据库

主数据库：MySQL

缓存：Redis

前端

语言：TypeScript

框架：Vue3 + Vite

UI 框架：Element Plus（前期可不加样式，先保证实用性）

其他

测试：JUnit + MockMVC（后端），Postman/Apifox（接口测试）

辅助：AI 编程软件（如 Cursor、Claude Code、ChatGPT Code Interpreter），辅助生成代码/测试脚本

三、开发流程
1. 文档驱动开发

树形文档结构：

总框架文档

子模块文档（数据库设计、接口文档、流程图）

测试文档

每完成一项子任务：

更新 文档、流程图、接口文档、进度表

同步更新总文档

2. 数据库先行

原则：数据库表与模块绑定

某模块需要的数据表 → 先建表、插入测试数据

确保接口开发和测试有依赖数据支撑

3. 单任务 AI 会话开发

打开一个新的 AI 会话，仅负责 一个子任务

流程：

输出伪代码 / 方法骨架

验证逻辑是否符合流程图

生成完整实现

编写/运行测试用例

4. 测试驱动开发 (TDD)

在实现某模块前：

定义接口文档

编写单元测试/Mock测试

插入数据库测试数据

开发接口实现

运行测试

5. 进度管理

总进度表：宏观任务划分

子进度表：每个模块完成后，更新任务状态

文档更新：每个子任务完成后，更新总文档（含数据库表、接口说明、测试记录）

四、模块化设计原则

热插拔模块化：每个学校数据源、专业学科、导师信息均为独立模块

多对多关系：

学校 ⇄ 学科

学校 ⇄ 导师

学生 ⇄ 学校 ⇄ 导师

五、AI 编程软件使用规范

避免一次性输出大量代码：

先输出伪代码 / 方法骨架

确认后再生成完整实现

对照流程图开发：

每个功能实现前，先画出流程图

验证逻辑正确后再写代码

测试命令示例：

后端接口测试：

curl -X GET "http://localhost:8080/api/school/list"


带参数测试：

curl -X POST "http://localhost:8080/api/school/add" \
-H "Content-Type: application/json" \
-d '{"name":"清华大学","location":"北京","level":"985"}'

六、开发流程图（简化示例）
flowchart TD
A[开始] --> B[编写接口文档]
B --> C[数据库建表 + 插入测试数据]
C --> D[画流程图]
D --> E[输出伪代码/方法骨架]
E --> F[生成完整代码实现]
F --> G[运行单元测试]
G --> H{测试通过?}
H -- 否 --> E
H -- 是 --> I[更新文档/进度表]
I --> J[结束]

七、开发方案总结

数据库先行：每个模块开发前先建表并准备测试数据

文档驱动：接口文档、流程图、数据库文档必须先行

AI 单任务开发：每个子任务独立 AI 会话，避免遗忘和混乱

测试驱动：开发前写测试，接口联调用 Apifox/Postman

进度管理：总进度表 + 子进度更新，确保迭代有序

前端简洁：前期去除样式，保证功能 → 后期再优化

八、模块
1. 高考择校模块

输入：高考成绩、兴趣方向、地域偏好

逻辑：匹配高校招生范围、专业分数线、兴趣方向

输出：推荐高校/专业；不符合则返回“不合适”

2. 研究生择导模块

输入：本科专业、科研经历、是否跨专业、研究方向兴趣

逻辑：匹配导师招生方向、跨专业要求、科研经历要求

输出：推荐导师名单；不符合返回“不合适”

3. 学校信息模块

功能：提供学校概况、强势学科、特色专业、招生简章

用途：作为择校时的参考数据

4. 用户管理模块

功能：用户注册、登录、角色（校内/校外）、权限控制

扩展：后期支持多角色（学生、教师、管理员）

5. 推荐与匹配算法模块

功能：抽象出通用匹配算法（可用于高考模块和研究生模块）

规则：可插拔算法策略，支持优先级调整（如成绩 > 兴趣 > 地域）

6. 数据管理模块

功能：

数据库建表（MySQL、Redis）

测试数据生成

数据缓存（热门院校、导师信息）

7. 系统管理模块（后台）

功能：

学校/导师/专业信息录入和更新

用户日志、操作记录

权限管理

前端展示模块

功能：

用户填写信息（成绩、兴趣等）表单

匹配结果展示

学校/导师信息展示页面

原则：先保证功能，后续优化样式

九、进度更新（2025-09-26）

子模块：高考择校模块前、后端端基本功能已完成
- 子模块：前端组件「高考模拟填报」已完成 v0.1 可运行版本
  - 代码位置：`frontend/src/components/GaokaoMockFill.vue`
  - 接口封装：`frontend/src/api/gaokao.ts`
  - DTO 类型：`frontend/src/types/dto.ts`
  - 运行方式：`npm install && npm run dev`（代理 `/api` 至 `http://localhost:8080`）
  - 子模块文档与测试记录：`doc/前端子模块：高考模拟填报组件.md`（含流程图、接口定义、手工测试日志）
  - 数据字典：`subjectType` 使用中文“物理/历史”；`东南大学` 层次为 `985`
  - 匹配逻辑：已实现“分数与位次综合匹配”
    - 若提供 rank：直接使用（但 rank>maskTopRank 时必须携带 score）
    - 若未提供 rank：通过 `rank_mapping(score→rank)` 映射得到 rank
    - 推荐使用“解析后的 rank”进行风控分桶与匹配度计算
  - 前端结果列：新增“去年最低分数(lastYearMinScore)”展示
  - 规则与校验：已开启“赋分制一致性校验”，已启用“分数达线优先（use-min-score-gate=true）”

新增子模块进度：「研究生择导模块（后端）」
- 当前状态：数据库先行已完成（新增研究生方向/院系/导师/名额/标签/论文/学生画像/志愿/匹配结果等表），并插入东南大学（单校）种子数据。
- 文档：`doc/子模块：研究生择导模块（后端）.md`（已含需求、流程、接口草案、表结构、测试清单）
- 下一步：基于表结构实现实体/仓库/服务/控制器与匹配逻辑；补充流程图与接口图；编写 JUnit 与 curl 覆盖正常/边界/异常用例。

九之二、进度更新（2025-09-27）

新增子模块进度：「研究生择导模块（前端）」
- 当前状态：前端 V1 可运行演示页完成，已对接后端接口草案与测试用例路径。
- 组件入口：`frontend/src/components/GradAdvisorSelect.vue`；已在 `frontend/src/App.vue` 中集成展示。
- 接口封装：`frontend/src/api/grad.ts`，覆盖画像保存/查询、导师检索 GET/POST、推荐 GET/POST、方向字典。
- 子模块文档与测试记录：`doc/前端子模块：研究生择导组件.md`（含流程图、接口映射、手工测试用例）。
- 运行方式：`npm install && npm run dev`，页面「研究生择导」板块进行手工测试。
- 后续计划：补充志愿清单 UI 与导师详情页，完善分页/筛选交互。

九之三、进度更新（2025-09-27 晚）

子模块：「研究生择导模块（前端）」— 交互与流程优化（已联调）
- 流程顺序重排（自上而下）：
  1) 填写基本信息 → 2) 方向字典（可选） → 3) Top‑N 重点方向（计算必填） → 4) 检索导师（可选） → 5) 获取推荐。
- 会话与用户标识：
  - 前端启动时调用 `POST /api/grad/session/init` 获取 `{userId, sessionId}`，所有 `/api/grad/**` 请求自动携带 `X-Session-Id`；userId 在前端隐藏，不再展示或输入。
- Top‑N 必填与去重：
  - 将“Top‑N 重点方向”设为计算必填；新增去重校验与“确认 Top‑N 方向”按钮；缺失或重复时高亮并滚动提示。
- 限流与提示：
  - 当服务端返回 429 时，读取 `Retry-After` 并在“查看推荐/重新计算推荐”按钮上展示倒计时禁用与黄条提示。
- 管理工具：
  - 新增“刷新字典缓存”按钮（仅开发/管理员可见），调用 `POST /api/grad/dicts/refresh`，字典与域映射更新可秒级生效。
- 文档同步：
  - 已更新 `doc/前端子模块：研究生择导组件.md` 的页面流程、会话/限流、Top‑N 必填与去重说明。

九之四、进度更新（2025-09-27 夜）

子模块：「研究生择导模块（后端）」— 策略模块化 + 会话与限流 + 自动化测试（已联调）
- 策略模块化：
  - 新增策略接口与上下文：`policy/RecommendPolicy`、`policy/PolicyContext`、`policy/ScoreAccumulator`。
  - 策略顺序：Threshold → DirectionProximity → TagBonus → QuotaPenalty → DomainPenalty → MissingInfoPenalty → MinScoreGate（行为与旧版一致）。
  - `GradRecommendServiceImpl` 接入流水线；`DictCacheService` 提供方向树/域映射/关键字缓存。
- 计算必填（Top‑N）：
  - 配置 `insufficientProfileMissingFieldsThreshold=1`，未选 Top‑N 时返回 `status=unfit, code=insufficient_profile`。
- 会话与限流：
  - `POST /api/grad/session/init` 返回 `{userId, sessionId}`；受保护接口携带 `X-Session-Id`。
  - 限流过滤器 `RateLimitFilter`：按会话/按IP每分钟限次；命中返回 429，包含 `Retry-After` 响应头（可配秒数）。
  - 会话清理任务：`SessionCleanupTask` 每小时清理过期会话（`sessionTtlDays` 可配）。
- 自动化测试：
  - `GradSessionAndRateLimitTests`：校验 session 初始化、会话/IP 限流与 `Retry-After` 头。
  - `GradSessionCleanupTests`：验证 `deleteOlderThan` 仅删除过期会话。
- 文档：
  - 已更新 `doc/子模块：研究生择导模块（后端）.md`：增加 12.6 会话与限流、12.7 Top‑N 必填、13.1 自动化测试说明。

九之五、进度更新（2025-09-27 深夜）

子模块：「学校信息模块（后端）」— 文档先行 + 数据库先行（准备联调）
- 文档：新增 `doc/子模块：学校信息模块（后端）.md`（含需求范围、流程图、表结构、接口草案、测试清单、种子数据片段）。
- 数据库：已在 `src/main/resources/schema.sql` 追加 `sch_*` 表结构；在 `src/main/resources/data.sql` 追加东南大学示例数据与字典。
- 说明：与高考模块复用的 `university/major` 保持解耦，学校信息模块采用独立 `sch_*` 表，避免耦合与便于扩展。
- 下一步：落地 Controller/Service/Mapper 骨架，先跑通 `GET /api/school/list` 与 `GET /api/school/{id}`，随后补齐学院/学科/专业/简章接口与 JUnit + curl 覆盖。

九之六、进度更新（2025-09-27 夜）

子模块：「学校信息模块（前端）」— 页面骨架 + API 封装（可运行联调）
- 当前状态：前端 V1 可运行页面完成，覆盖检索/列表/详情与“强势学科/特色专业/招生简章”三分栏展示。
- 组件入口：`frontend/src/components/SchoolInfo.vue`；已在 `frontend/src/App.vue` 中集成展示。
- 接口封装：`frontend/src/api/school.ts`，对齐后端接口草案（`/api/school/list`、`/api/school/{id}`、`/disciplines/strength`、`/majors`、`/brochures`、字典/标签）。
- 子模块文档与测试记录：`doc/前端子模块：学校信息组件.md`（含流程图、接口映射、手工测试用例）。
- 运行方式：`npm install && npm run dev`，页面「学校信息」板块进行手工测试。
- 分页与加载：已为列表与三分栏补充分页与加载状态；列表区显示“总条数/总页数”，兼容 Spring Page（优先读取 `data.content`/`data.last`/`data.totalElements`/`data.totalPages`）。
- 后续计划：补充骨架屏、简介 Markdown 渲染、学科/专业筛选与标签检索联动。

九之七、进度更新（2025-09-27 深夜）

前端：页面分离与系统首页（Router 集成）
- 变更摘要：
  - 引入 `vue-router@4`，将原先单页内的多个模块板块拆分为独立路由页面。
  - 新增系统首页 `frontend/src/pages/Home.vue`，提供模块入口卡片。
  - 新增路由配置 `frontend/src/router/index.ts`，路由如下：
    - `/` → 首页（`Home.vue`）
    - `/gaokao` → 高考模拟填报（`components/GaokaoMockFill.vue`）
    - `/grad` → 研究生择导（`components/GradAdvisorSelect.vue`）
    - `/school` → 学校信息（`components/SchoolInfo.vue`）
  - 调整 `frontend/src/main.ts` 挂载 Router；重构 `frontend/src/App.vue` 为导航壳层（导航条 + `<RouterView />`）。

- 文件清单：
  - 新增：`frontend/src/router/index.ts`
  - 新增：`frontend/src/pages/Home.vue`
  - 修改：`frontend/src/main.ts`（安装 `router`）
  - 修改：`frontend/src/App.vue`（移除内嵌模块组件，加入导航与 `<RouterView />`）
  - 依赖：`frontend/package.json` 增加 `vue-router` 依赖

- 运行与测试：
  1) 安装依赖并启动（首次或新增依赖后执行）
     - `cd frontend && npm install`
     - `npm run dev`
  2) 浏览器访问 `http://localhost:5173/`，检查：首页卡片导航可见。
  3) 路由测试：
     - 点击“高考模拟填报” → 页面路径切换至 `/gaokao`，表单与结果展示正常；
     - 点击“研究生择导” → 路径 `/grad`，按文档流程手测；
     - 点击“学校信息” → 路径 `/school`，检索/分页/详情与三分栏加载正常；
     - 刷新任一路径页面，客户端路由可正常恢复（Vite dev 下默认支持）。

- 后续建议：
  - 增加面包屑与标题同步（基于 `meta.title` 动态设置 `document.title`）。
  - 引入基础布局组件与菜单激活态高亮优化；
  - 生产部署时配置前端服务器的 history fallback（如 Nginx `try_files`）。


首页 UI 与交互增强”子任务的增量说明，

- 新增子模块文档：`doc/前端子模块：首页UI与交互增强.md`
- 变更范围：`frontend/src/pages/Home.vue`、`frontend/src/App.vue`、`frontend/src/styles/theme.css`
- 关键能力：热门专业方向/高校一览横向滚动、研究洞察交错切入、数据概览计数动画、无障碍动效降级
- 测试记录：见子模块文档第7节

九之八、进度更新（2025-09-27 夜）

前端：高考模拟填报页面美化与现代化升级
- 变更摘要：
  - 将高考模拟填报组件从基础功能界面升级为现代化学术风格界面
  - 采用深蓝色渐变主题，体现教育专业性，与系统整体设计风格保持一致
  - 重构UI结构，提升用户体验和视觉效果

- 主要改进内容：
  - **页面标题区域**：添加渐变背景、浮动动画效果，展示系统统计数据
  - **表单区域优化**：按功能分区块（基础信息、成绩信息、偏好设置、意向选择），增强视觉层次
  - **结果展示美化**：标签页重设计、表格优化（颜色标签、进度条、格式化显示）、空状态设计
  - **交互体验提升**：按钮动效、卡片悬停、加载状态、响应式适配

- 技术实现：
  - 新增500+行现代化CSS样式，使用CSS变量继承全局主题
  - 添加3个辅助方法：`getTierTagType()`、`getTrendTagType()`、`formatTuition()`
  - 支持响应式设计和无障碍访问（prefers-reduced-motion）

- 文件变更：
  - 修改：`frontend/src/components/GaokaoMockFill.vue`（重构模板结构和样式）
  - 更新：`doc/前端子模块：高考模拟填报组件.md`（新增第12节UI美化文档）

- 测试验证：
  - 桌面端和移动端响应式布局正常
  - 所有交互功能（按钮、表单、标签页）工作正常
  - 动画效果流畅，性能良好

- 后续优化建议：深色模式支持、数据可视化图表、个性化主题定制


九之九、进度更新（2025-09-28）

前端：首页深度美化与现代化升级
- 变更摘要：
  - 对系统首页进行全面的现代化美化升级，提升用户体验和视觉效果
  - 采用现代化设计语言，包括动态粒子背景、毛玻璃效果、渐变色彩等
  - 重构所有主要区域的视觉设计和交互效果

- 主要改进内容：
  - **Hero区域全面重设计**：
    - 添加动态粒子背景效果（15个随机运动彩色粒子）
    - 多层渐变背景 + 毛玻璃效果（backdrop-filter）
    - 智能匹配系统徽章（带脉冲动画）
    - 标题分层设计（渐变文字 + 普通文字，3.5rem大字体）
    - 数据统计展示（120+高校、900+导师、98%准确率）
    - 按钮升级（渐变背景 + 光效动画 + 图标）
    - 右侧浮动卡片（3个功能卡片 + 装饰环旋转动画）

  - **功能卡片区域升级**：
    - 渐变顶部指示条（悬停展开）
    - 增强悬停效果（垂直位移 + 缩放 + 动态阴影）
    - 现代化20px圆角 + 背景渐变

  - **功能特性区域现代化**：
    - 毛玻璃卡片设计（backdrop-filter + 半透明背景）
    - 独立特性卡片（支持悬停效果）
    - 24px图标 + 颜色主题统一

  - **分节标题重设计**：
    - 渐变色彩条（6px宽度 + 阴影效果）
    - 大字体标题（1.5rem + 700字重）
    - 延伸装饰线条

  - **热门专业展示优化**：
    - 现代化容器（24px圆角 + 毛玻璃效果）
    - 专业卡片升级（渐变顶部指示条 + 圆形趋势图标）
    - 统计数据标签化（绿色背景 + 圆角设计）
    - 渐变色滚动条美化

  - **高校一览现代化**：
    - 大尺寸卡片（350-450px宽度 + 16:10比例）
    - 渐变顶部条（悬停展开）
    - 位置图标（📍 emoji）+ CTA按钮优化
    - 图片叠加效果（悬停显示半透明层）

  - **数据概览升级**：
    - 现代化统计卡片（渐变顶部装饰条 + 数字渐变色彩）
    - 悬停微动效果 + 渐变分隔线

  - **研究洞察区域美化**：
    - 图片卡片（24px圆角 + 深度阴影 + 悬停缩放）
    - 文本卡片（毛玻璃背景 + 边框 + 悬停上移）
    - 标题渐变色彩 + 改进的字体大小和间距

  - **全局样式优化**：
    - 页面加载动画（淡入上移效果）
    - 滚动条美化（全局渐变色）
    - 文本选择样式（蓝色主题）
    - 焦点样式（蓝色轮廓 + 偏移）
    - 无障碍支持（prefers-reduced-motion适配）

- 技术实现亮点：
  - **CSS技术**：CSS Grid、Flexbox、CSS变量、渐变背景、毛玻璃效果、CSS动画
  - **交互设计**：微交互、视觉反馈、流畅动画、性能优化
  - **响应式设计**：移动端适配、弹性布局、字体缩放、触摸友好

- 视觉设计系统：
  - **色彩方案**：蓝色系主色调（#1E3A8A, #3B82F6, #8B5CF6）+ 辅助色
  - **字体系统**：700-800字重标题 + 400-500字重正文
  - **间距系统**：20-40px容器间距 + 12-24px圆角半径

- 文件变更：
  - 修改：`frontend/src/pages/Home.vue`（从406行增加到1512行）
  - 新增：`doc/前端子模块：首页深度美化记录.md`（详细美化文档）

- 性能优化：
  - GPU加速动画（transform和opacity）
  - 减少重绘（避免改变布局属性）
  - 无障碍支持（prefers-reduced-motion）
  - 响应式优化（移动端优先设计）

- 测试验证：
  - 各浏览器兼容性正常
  - 不同屏幕尺寸适配良好
  - 动画流畅度和性能表现优秀
  - 移动端交互体验良好

- 后续优化方向：主题切换功能、暗色模式、更多交互动画、内容优化

解决error while editing问题方法：
将原因的框架代码复制给chatgpt进行美化，然后让windsurf进行修复错误